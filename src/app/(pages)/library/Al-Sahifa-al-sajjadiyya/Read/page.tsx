"use client";

import { useState, useRef, useEffect, useMemo } from "react";
import Breadcrumbs from "@/components/breadcrumb";
import Link from "next/link";
export default function Readpage() {
  const [searchInput, setSearchInput] = useState("");
  const [searchTerm, setSearchTerm] = useState("");
  const [suggestions, setSuggestions] = useState<string[]>([]);
  const [showSuggestions, setShowSuggestions] = useState(false);

  const text =
    "في زاوية مقهى قديم، جلستُ أراقب عقارب الساعة وهي تتسابق كأنها تهرب من شيء لا أدركه. كانت الأضواء الخافتة تنعكس على الطاولات الخشبية، حيث تجمعت فيها آثار قهوة منسية وسطور كتب مهملة، وكأنها تشهد على قصص لم تكتمل بعد.";

  // استخراج الكلمات الفريدة باستخدام `useMemo` لتحسين الأداء
  const words = useMemo(() => {
    return Array.from(new Set(cleanArabicText(text).split(/\s+/))).filter(
      (word) => word.length > 2
    );
  }, [text]);

  // تحديث التنبؤات أثناء الكتابة
  useEffect(() => {
    if (searchInput.trim()) {
      const inputCleaned = cleanArabicText(searchInput);
      const filtered = words.filter(
        (word) => word.includes(inputCleaned) // البحث باستخدام أجزاء الكلمة، وليس فقط البداية
      );
      setSuggestions(filtered);
      setShowSuggestions(true);
    } else {
      setShowSuggestions(false);
    }
  }, [searchInput, words]);

  // تنفيذ البحث عند الضغط على Enter
  const handleKeyPress = (e: React.KeyboardEvent<HTMLInputElement>) => {
    if (e.key === "Enter") {
      setSearchTerm(searchInput);
      setShowSuggestions(false); // إخفاء القائمة عند البحث
    }
  };

  return (
    <div className="">
      <Breadcrumbs
        links={[
          { name: "الرئيسية", url: "/" },
          { name: "المكتبة التخصصية", url: "/library" },
          {
            name: "الصحيفة السجادية",
            url: "/library/al-sahifa-al-sajjadiyya",
          },
        ]}
        className="container"
      />

      <div className=" container xl:mx-auto ">
        <div className="mb-4 relative">
          <input
            type="text"
            value={searchInput}
            onChange={(e) => setSearchInput(e.target.value)}
            placeholder="ابحث عن كلمة..."
            className="border p-2 rounded w-64"
            onFocus={() => setShowSuggestions(true)}
            onKeyDown={handleKeyPress} // تنفيذ البحث عند الضغط على Enter
          />
          {showSuggestions && suggestions.length > 0 && (
            <ul className="absolute bg-white border w-64 mt-1 rounded shadow-md max-h-40 overflow-auto">
              {suggestions.map((word, index) => (
                <li
                  key={index}
                  className="p-2 cursor-pointer hover:bg-gray-200"
                  onClick={() => {
                    setSearchInput(word); // إدخال الكلمة في الحقل
                    setShowSuggestions(false); // إخفاء القائمة
                  }}
                >
                  {word}
                </li>
              ))}
            </ul>
          )}
          <button
            onClick={() => setSearchTerm(searchInput)}
            className="ml-2 px-4 py-2 bg-primary text-white rounded"
          >
            بحث
          </button>
        </div>
        <div className=" border-r-4  m-2 flex sm:flex-row  flex-col">
          <div className="bg-gray-100 w-full sm:w-1/5 h-auto sm:h-[700px] p-6 text-center  border-b-4 flex flex-col">
            <Link href="#section1">#section1</Link>
            <Link href="#section2">#section2</Link>
            <Link href="#section3">#section3</Link>
            <Link href="#section4">#section4</Link>
            <Link href="#section5">#section5</Link>
            <Link href="#section6">#section6</Link>
            <Link href="#section4">#section4</Link>
            <Link href="#section5">#section5</Link>
            <Link href="#section6">#section6</Link>
            <Link href="#section4">#section4</Link>
            <Link href="#section5">#section5</Link>
            <Link href="#section6">#section6</Link>
          </div>
          <div dir="ltr" className=" w-full ">
            <div className="bg-neutral-50 h-[700px]  overflow-y-scroll  overscroll-y-contain p-8 ">
              <div dir="rtl">
                <div id="section1">
                  <HighlightedText searchTerm={searchTerm}>
                    في زاوية مقهى قديم، جلستُ أراقب عقارب الساعة وهي تتسابق
                    كأنها تهرب من شيء لا أدركه. كانت الأضواء الخافتة تنعكس على
                    الطاولات الخشبية، حيث تجمعت فيها آثار قهوة منسية وسطور كتب
                    مهملة، وكأنها تشهد على قصص لم تكتمل بعد. في الخارج، كانت
                    الرياح تعبث بأوراق الأشجار، تحمل معها أسرار العابرين، تهمس
                    بها إلى النوافذ المغلقة وتتنهد بين الأزقة الضيقة. كم مرة
                    مررتُ بهذه الشوارع دون أن ألاحظ تفاصيلها؟ كم من اللحظات
                    عبرتني دون أن أحتضنها؟ أدرتُ نظري إلى الوجوه حولي، كل وجه
                    يحمل رواية صامتة، ملامح حكاية مكتومة. هناك رجل مسنٌّ يحدق في
                    فنجانه كأنه يبحث في أعماقه عن ماضٍ سُرق منه، وشابٌ يكتب
                    بحماس وكأنه يسابق الزمن ليحفر اسمه في ذاكرة الكون، وامرأة
                    تحدّق من النافذة بعينين تائهتين، كأنها تنتظر أحدًا لن يعود.
                    اكثر ChatGPT said: عزفٌ على أوتار الزمن في زاوية مقهى قديم،
                    جلستُ أراقب عقارب الساعة وهي تتسابق كأنها تهرب من شيء لا
                    أدركه. كانت الأضواء الخافتة تنعكس على الطاولات الخشبية، حيث
                    تجمعت عليها آثار قهوة منسية وسطور كتب مهملة، وكأنها تشهد على
                    قصص لم تكتمل بعد. الهواء مشبع برائحة البن المعتّق، وصوت
                    فيروز الخافت يتسلل من مذياع قديم، يُغرق المكان في حنينٍ
                    ناعم، كأن الزمن توقف هنا منذ عقود، متحججًا بحنين البشر إلى
                    لحظات مضت. في الخارج، كانت الرياح تعبث بأوراق الأشجار، تحمل
                    معها أسرار العابرين، تهمس بها إلى النوافذ المغلقة، وتتنهد
                    بين الأزقة الضيقة. كم مرة مررتُ بهذه الشوارع دون أن ألاحظ
                    تفاصيلها؟ كم من اللحظات عبرتني دون أن أحتضنها؟ هناك شيء غريب
                    في مرور الأيام، كأنها ترحل دون أن تمنحنا فرصة وداع لائق، أو
                    ربما نحن الذين نظل منشغلين بما هو آتٍ، متجاهلين ما هو بين
                    أيدينا. على الطاولة المجاورة، كان هناك رجل مسنٌّ يحدق في
                    فنجانه كأنه يبحث في أعماقه عن ماضٍ سُرق منه. عيناه تحملان
                    ثقل الزمن، كأنهما تخبئان خلفهما ألف حكاية وحكاية. ترى، هل
                    يندم على شيء؟ هل يتمنى لو يعود به العمر ليحكي قصة أخرى،
                    مختلفة عن التي عاشها؟ قربه، شابٌ يحمل قلمًا بين أصابعه، يكتب
                    بحماس وكأنه يسابق الزمن ليحفر اسمه في ذاكرة الكون. في عينيه
                    وميض الأحلام، لم تخدشه الأيام بعد، ولم تخبُ شعلة الشغف في
                    داخله. بينما هناك، عند النافذة، جلست امرأة تحدّق خارجًا
                    بعينين تائهتين، وكأنها تنتظر أحدًا لن يعود. ربما تنتظر رسالة
                    لم تصل، أو حلمًا تأخر في الوصول، أو ربما تنتظر فقط أن تمضي
                    اللحظة، دون أن تأخذ منها شيئًا آخر. تأملتُ المشهد من حولي،
                    هذا التباين الغريب بين مَن يعيش اللحظة، ومن يحاول الفرار
                    منها، وبين من يحنُّ إلى ما فات، ومن يسابق ما هو قادم. أليس
                    هذا حالنا جميعًا؟ نحن أبناء الزمن، نحبه ونكرهه، نركض خلفه
                    ونفرُّ منه، نغرق في الذكريات ونتعثر في المستقبل. لكن الحقيقة
                    الوحيدة هي أن الزمن يمضي، سواء أردنا ذلك أم لا، فلا هو
                    ينتظرنا، ولا نحن نستطيع إيقافه. سألت نفسي، كم مرة عشتُ
                    اللحظة حقًا؟ كم مرة توقفتُ عن الركض لأتأمل الحياة وهي تمر
                    أمامي؟ ربما حان الوقت لأتوقف عن التفكير في الأمس والغد،
                    لأمنح اليوم فرصة أن يكون يومًا يستحق أن يُعاش. نهضتُ من
                    مكاني، احتسيتُ آخر رشفة من قهوتي، وشعرتُ كأن نكهتها مختلفة
                    هذه المرة، وكأنني أتذوقها لأول مرة. نظرتُ إلى الرجل المسن،
                    إلى الشاب الطموح، إلى المرأة المنتظرة، وإلى الطفل الصغير
                    الذي يلهو في ركن بعيد من المقهى، كأن العالم بين يديه، لم
                    يتلوث بعد بهموم الوقت وضغوط الانتظار. ابتسمتُ، ثم غادرتُ
                    المقهى بخطوات هادئة، لكن بروح تشتعل بالشغف، وابتسامة تحمل
                    وعدًا بأنني، منذ هذه اللحظة، سأكون حاضرًا في حياتي حقًا، لا
                    مجرد عابر فيها. لأن الحياة ليست ما ننتظره، بل ما نعيشه
                    الآن.اكثر ChatGPT said: عزفٌ على أوتار الزمن في زاوية مقهى
                    قديم، جلستُ أراقب عقارب الساعة وهي تتسابق كأنها تهرب من شيء
                    لا أدركه. كانت الأضواء الخافتة تنعكس على الطاولات الخشبية،
                    حيث تجمعت عليها آثار قهوة منسية وسطور كتب مهملة، وكأنها تشهد
                    على قصص لم تكتمل بعد. الهواء مشبع برائحة البن المعتّق، وصوت
                    فيروز الخافت يتسلل من مذياع قديم، يُغرق المكان في حنينٍ
                    ناعم، كأن الزمن توقف هنا منذ عقود، متحججًا بحنين البشر إلى
                    لحظات مضت. في الخارج، كانت الرياح تعبث بأوراق الأشجار، تحمل
                    معها أسرار العابرين، تهمس بها إلى النوافذ المغلقة، وتتنهد
                    بين الأزقة الضيقة. كم مرة مررتُ بهذه الشوارع دون أن ألاحظ
                    تفاصيلها؟ كم من اللحظات عبرتني دون أن أحتضنها؟ هناك شيء غريب
                    في مرور الأيام، كأنها ترحل دون أن تمنحنا فرصة وداع لائق، أو
                    ربما نحن الذين نظل منشغلين بما هو آتٍ، متجاهلين ما هو بين
                    أيدينا. على الطاولة المجاورة، كان هناك رجل مسنٌّ يحدق في
                    فنجانه كأنه يبحث في أعماقه عن ماضٍ سُرق منه. عيناه تحملان
                    ثقل الزمن، كأنهما تخبئان خلفهما ألف حكاية وحكاية. ترى، هل
                    يندم على شيء؟ هل يتمنى لو يعود به العمر ليحكي قصة أخرى،
                    مختلفة عن التي عاشها؟ قربه، شابٌ يحمل قلمًا بين أصابعه، يكتب
                    بحماس وكأنه يسابق الزمن ليحفر اسمه في ذاكرة الكون. في عينيه
                    وميض الأحلام، لم تخدشه الأيام بعد، ولم تخبُ شعلة الشغف في
                    داخله. بينما هناك، عند النافذة، جلست امرأة تحدّق خارجًا
                    بعينين تائهتين، وكأنها تنتظر أحدًا لن يعود. ربما تنتظر رسالة
                    لم تصل، أو حلمًا تأخر في الوصول، أو ربما تنتظر فقط أن تمضي
                    اللحظة، دون أن تأخذ منها شيئًا آخر. تأملتُ المشهد من حولي،
                    هذا التباين الغريب بين مَن يعيش اللحظة، ومن يحاول الفرار
                    منها، وبين من يحنُّ إلى ما فات، ومن يسابق ما هو قادم. أليس
                    هذا حالنا جميعًا؟ نحن أبناء الزمن، نحبه ونكرهه، نركض خلفه
                    ونفرُّ منه، نغرق في الذكريات ونتعثر في المستقبل. لكن الحقيقة
                    الوحيدة هي أن الزمن يمضي، سواء أردنا ذلك أم لا، فلا هو
                    ينتظرنا، ولا نحن نستطيع إيقافه. سألت نفسي، كم مرة عشتُ
                    اللحظة حقًا؟ كم مرة توقفتُ عن الركض لأتأمل الحياة وهي تمر
                    أمامي؟ ربما حان الوقت لأتوقف عن التفكير في الأمس والغد،
                    لأمنح اليوم فرصة أن يكون يومًا يستحق أن يُعاش. نهضتُ من
                    مكاني، احتسيتُ آخر رشفة من قهوتي، وشعرتُ كأن نكهتها مختلفة
                    هذه المرة، وكأنني أتذوقها لأول مرة. نظرتُ إلى الرجل المسن،
                    إلى الشاب الطموح، إلى المرأة المنتظرة، وإلى الطفل الصغير
                    الذي يلهو في ركن بعيد من المقهى، كأن العالم بين يديه، لم
                    يتلوث بعد بهموم الوقت وضغوط الانتظار. ابتسمتُ، ثم غادرتُ
                    المقهى بخطوات هادئة، لكن بروح تشتعل بالشغف، وابتسامة تحمل
                    وعدًا بأنني، منذ هذه اللحظة، سأكون حاضرًا في حياتي حقًا، لا
                    مجرد عابر فيها. لأن الحياة ليست ما ننتظره، بل ما نعيشه الآن.
                    أدركتُ حينها أن الزمن ليس مجرد عقارب تدور، بل هو أنفاس
                    تُسلب، وأحلام تُطوى، وذكريات تُخزن في زوايا القلب. لكنه
                    أيضًا فرصة أخرى، صباحٌ جديد يولد من رحم الليل، فرصة لنغني،
                    لنكتب، لنضحك، ولنهمس لمن نحب: "لا تترك يدي، فالحياة أقصر مما
                    نعتقد."
                  </HighlightedText>
                </div>
                <div id="section2"></div>
                <HighlightedText searchTerm={searchTerm}>
                  اكثر ChatGPT said: عزفٌ على أوتار الزمن في زاوية مقهى قديم،
                  جلستُ أراقب عقارب الساعة وهي تتسابق كأنها تهرب من شيء لا
                  أدركه. كانت الأضواء الخافتة تنعكس على الطاولات الخشبية، حيث
                  تجمعت عليها آثار قهوة منسية وسطور كتب مهملة، وكأنها تشهد على
                  قصص لم تكتمل بعد. الهواء مشبع برائحة البن المعتّق، وصوت فيروز
                  الخافت يتسلل من مذياع قديم، يُغرق المكان في حنينٍ ناعم، كأن
                  الزمن توقف هنا منذ عقود، متحججًا بحنين البشر إلى لحظات مضت. في
                  الخارج، كانت الرياح تعبث بأوراق الأشجار، تحمل معها أسرار
                  العابرين، تهمس بها إلى النوافذ المغلقة، وتتنهد بين الأزقة
                  الضيقة. كم مرة مررتُ بهذه الشوارع دون أن ألاحظ تفاصيلها؟ كم من
                  اللحظات عبرتني دون أن أحتضنها؟ هناك شيء غريب في مرور الأيام،
                  كأنها ترحل دون أن تمنحنا فرصة وداع لائق، أو ربما نحن الذين نظل
                  منشغلين بما هو آتٍ، متجاهلين ما هو بين أيدينا. على الطاولة
                  المجاورة، كان هناك رجل مسنٌّ يحدق في فنجانه كأنه يبحث في
                  أعماقه عن ماضٍ سُرق منه. عيناه تحملان ثقل الزمن، كأنهما تخبئان
                  خلفهما ألف حكاية وحكاية. ترى، هل يندم على شيء؟ هل يتمنى لو
                  يعود به العمر ليحكي قصة أخرى، مختلفة عن التي عاشها؟ قربه، شابٌ
                  يحمل قلمًا بين أصابعه، يكتب بحماس وكأنه يسابق الزمن ليحفر اسمه
                  في ذاكرة الكون. في عينيه وميض الأحلام، لم تخدشه الأيام بعد،
                  ولم تخبُ شعلة الشغف في داخله. بينما هناك، عند النافذة، جلست
                  امرأة تحدّق خارجًا بعينين تائهتين، وكأنها تنتظر أحدًا لن يعود.
                  ربما تنتظر رسالة لم تصل، أو حلمًا تأخر في الوصول، أو ربما
                  تنتظر فقط أن تمضي اللحظة، دون أن تأخذ منها شيئًا آخر. تأملتُ
                  المشهد من حولي، هذا التباين الغريب بين مَن يعيش اللحظة، ومن
                  يحاول الفرار منها، وبين من يحنُّ إلى ما فات، ومن يسابق ما هو
                  قادم. أليس هذا حالنا جميعًا؟ نحن أبناء الزمن، نحبه ونكرهه،
                  نركض خلفه ونفرُّ منه، نغرق في الذكريات ونتعثر في المستقبل. لكن
                  الحقيقة الوحيدة هي أن الزمن يمضي، سواء أردنا ذلك أم لا، فلا هو
                  ينتظرنا، ولا نحن نستطيع إيقافه. سألت نفسي، كم مرة عشتُ اللحظة
                  حقًا؟ كم مرة توقفتُ عن الركض لأتأمل الحياة وهي تمر أمامي؟ ربما
                  حان الوقت لأتوقف عن التفكير في الأمس والغد، لأمنح اليوم فرصة
                  أن يكون يومًا يستحق أن يُعاش. نهضتُ من مكاني، احتسيتُ آخر رشفة
                  من قهوتي، وشعرتُ كأن نكهتها مختلفة هذه المرة، وكأنني أتذوقها
                  لأول مرة. نظرتُ إلى الرجل المسن، إلى الشاب الطموح، إلى المرأة
                  المنتظرة، وإلى الطفل الصغير الذي يلهو في ركن بعيد من المقهى،
                  كأن العالم بين يديه، لم يتلوث بعد بهموم الوقت وضغوط الانتظار.
                  ابتسمتُ، ثم غادرتُ المقهى بخطوات هادئة، لكن بروح تشتعل بالشغف،
                  وابتسامة تحمل وعدًا بأنني، منذ هذه اللحظة، سأكون حاضرًا في
                  حياتي حقًا، لا مجرد عابر فيها. لأن الحياة ليست ما ننتظره، بل
                  ما نعيشه الآن.اكثر ChatGPT said: عزفٌ على أوتار الزمن في زاوية
                  مقهى قديم، جلستُ أراقب عقارب الساعة وهي تتسابق كأنها تهرب من
                  شيء لا أدركه. كانت الأضواء الخافتة تنعكس على الطاولات الخشبية،
                  حيث تجمعت عليها آثار قهوة منسية وسطور كتب مهملة، وكأنها تشهد
                  على قصص لم تكتمل بعد. الهواء مشبع برائحة البن المعتّق، وصوت
                  فيروز الخافت يتسلل من مذياع قديم، يُغرق المكان في حنينٍ ناعم،
                  كأن الزمن توقف هنا منذ عقود، متحججًا بحنين البشر إلى لحظات
                  مضت. في الخارج، كانت الرياح تعبث بأوراق الأشجار، تحمل معها
                  أسرار العابرين، تهمس بها إلى النوافذ المغلقة، وتتنهد بين
                  الأزقة الضيقة. كم مرة مررتُ بهذه الشوارع دون أن ألاحظ
                  تفاصيلها؟ كم من اللحظات عبرتني دون أن أحتضنها؟ هناك شيء غريب
                  في مرور الأيام، كأنها ترحل دون أن تمنحنا فرصة وداع لائق، أو
                  ربما نحن الذين نظل منشغلين بما هو آتٍ، متجاهلين ما هو بين
                  أيدينا. على الطاولة المجاورة، كان هناك رجل مسنٌّ يحدق في
                  فنجانه كأنه يبحث في أعماقه عن ماضٍ سُرق منه. عيناه تحملان ثقل
                  الزمن، كأنهما تخبئان خلفهما ألف حكاية وحكاية. ترى، هل يندم على
                  شيء؟ هل يتمنى لو يعود به العمر ليحكي قصة أخرى، مختلفة عن التي
                  عاشها؟ قربه، شابٌ يحمل قلمًا بين أصابعه، يكتب بحماس وكأنه
                  يسابق الزمن ليحفر اسمه في ذاكرة الكون. في عينيه وميض الأحلام،
                  لم تخدشه الأيام بعد، ولم تخبُ شعلة الشغف في داخله. بينما هناك،
                  عند النافذة، جلست امرأة تحدّق خارجًا بعينين تائهتين، وكأنها
                  تنتظر أحدًا لن يعود. ربما تنتظر رسالة لم تصل، أو حلمًا تأخر في
                  الوصول، أو ربما تنتظر فقط أن تمضي اللحظة، دون أن تأخذ منها
                  شيئًا آخر. تأملتُ المشهد من حولي، هذا التباين الغريب بين مَن
                  يعيش اللحظة، ومن يحاول الفرار منها، وبين من يحنُّ إلى ما فات،
                  ومن يسابق ما هو قادم. أليس هذا حالنا جميعًا؟ نحن أبناء الزمن،
                  نحبه ونكرهه، نركض خلفه ونفرُّ منه، نغرق في الذكريات ونتعثر في
                  المستقبل. لكن الحقيقة الوحيدة هي أن الزمن يمضي، سواء أردنا ذلك
                  أم لا، فلا هو ينتظرنا، ولا نحن نستطيع إيقافه. سألت نفسي، كم
                  مرة عشتُ اللحظة حقًا؟ كم مرة توقفتُ عن الركض لأتأمل الحياة وهي
                  تمر أمامي؟ ربما حان الوقت لأتوقف عن التفكير في الأمس والغد،
                  لأمنح اليوم فرصة أن يكون يومًا يستحق أن يُعاش. نهضتُ من مكاني،
                  احتسيتُ آخر رشفة من قهوتي، وشعرتُ كأن نكهتها مختلفة هذه المرة،
                  وكأنني أتذوقها لأول مرة. نظرتُ إلى الرجل المسن، إلى الشاب
                  الطموح، إلى المرأة المنتظرة، وإلى الطفل الصغير الذي يلهو في
                  ركن بعيد من المقهى، كأن العالم بين يديه، لم يتلوث بعد بهموم
                  الوقت وضغوط الانتظار. ابتسمتُ، ثم غادرتُ المقهى بخطوات هادئة،
                  لكن بروح تشتعل بالشغف، وابتسامة تحمل وعدًا بأنني، منذ هذه
                  اللحظة، سأكون حاضرًا في حياتي حقًا، لا مجرد عابر فيها. لأن
                  الحياة ليست ما ننتظره، بل ما نعيشه الآن.
                </HighlightedText>{" "}
                <div id="section3"></div>
                <HighlightedText searchTerm={searchTerm}>
                  نهضتُ من مكاني، احتسيتُ آخر رشفة من قهوتي، وغادرتُ المقهى
                  بخطوات هادئة، لكن بروح تشتعل بالشغف. قررتُ أن أعيش اللحظة، أن
                  أعانق الحياة كما هي، بأوجاعها وأفراحها، لأن كل ثانية تمضي هي
                  نغمة في لحن الزاكثر ChatGPT said: عزفٌ على أوتار الزمن في
                  زاوية مقهى قديم، جلستُ أراقب عقارب الساعة وهي تتسابق كأنها
                  تهرب من شيء لا أدركه. كانت الأضواء الخافتة تنعكس على الطاولات
                  الخشبية، حيث تجمعت عليها آثار قهوة منسية وسطور كتب مهملة،
                  وكأنها تشهد على قصص لم تكتمل بعد. الهواء مشبع برائحة البن
                  المعتّق، وصوت فيروز الخافت يتسلل من مذياع قديم، يُغرق المكان
                  في حنينٍ ناعم، كأن الزمن توقف هنا منذ عقود، متحججًا بحنين
                  البشر إلى لحظات مضت. في الخارج، كانت الرياح تعبث بأوراق
                  الأشجار، تحمل معها أسرار العابرين، تهمس بها إلى النوافذ
                  المغلقة، وتتنهد بين الأزقة الضيقة. كم مرة مررتُ بهذه الشوارع
                  دون أن ألاحظ تفاصيلها؟ كم من اللحظات عبرتني دون أن أحتضنها؟
                  هناك شيء غريب في مرور الأيام، كأنها ترحل دون أن تمنحنا فرصة
                  وداع لائق، أو ربما نحن الذين نظل منشغلين بما هو آتٍ، متجاهلين
                  ما هو بين أيدينا. على الطاولة المجاورة، كان هناك رجل مسنٌّ
                  يحدق في فنجانه كأنه يبحث في أعماقه عن ماضٍ سُرق منه. عيناه
                  تحملان ثقل الزمن، كأنهما تخبئان خلفهما ألف حكاية وحكاية. ترى،
                  هل يندم على شيء؟ هل يتمنى لو يعود به العمر ليحكي قصة أخرى،
                  مختلفة عن التي عاشها؟ قربه، شابٌ يحمل قلمًا بين أصابعه، يكتب
                  بحماس وكأنه يسابق الزمن ليحفر اسمه في ذاكرة الكون. في عينيه
                  وميض الأحلام، لم تخدشه الأيام بعد، ولم تخبُ شعلة الشغف في
                  داخله. بينما هناك، عند النافذة، جلست امرأة تحدّق خارجًا بعينين
                  تائهتين، وكأنها تنتظر أحدًا لن يعود. ربما تنتظر رسالة لم تصل،
                  أو حلمًا تأخر في الوصول، أو ربما تنتظر فقط أن تمضي اللحظة، دون
                  أن تأخذ منها شيئًا آخر. تأملتُ المشهد من حولي، هذا التباين
                  الغريب بين مَن يعيش اللحظة، ومن يحاول الفرار منها، وبين من
                  يحنُّ إلى ما فات، ومن يسابق ما هو قادم. أليس هذا حالنا جميعًا؟
                  نحن أبناء الزمن، نحبه ونكرهه، نركض خلفه ونفرُّ منه، نغرق في
                  الذكريات ونتعثر في المستقبل. لكن الحقيقة الوحيدة هي أن الزمن
                  يمضي، سواء أردنا ذلك أم لا، فلا هو ينتظرنا، ولا نحن نستطيع
                  إيقافه. سألت نفسي، كم مرة عشتُ اللحظة حقًا؟ كم مرة توقفتُ عن
                  الركض لأتأمل الحياة وهي تمر أمامي؟ ربما حان الوقت لأتوقف عن
                  التفكير في الأمس والغد، لأمنح اليوم فرصة أن يكون يومًا يستحق
                  أن يُعاش. نهضتُ من مكاني، احتسيتُ آخر رشفة من قهوتي، وشعرتُ
                  كأن نكهتها مختلفة هذه المرة، وكأنني أتذوقها لأول مرة. نظرتُ
                  إلى الرجل المسن، إلى الشاب الطموح، إلى المرأة المنتظرة، وإلى
                  الطفل الصغير الذي يلهو في ركن بعيد من المقهى، كأن العالم بين
                  يديه، لم يتلوث بعد بهموم الوقت وضغوط الانتظار. ابتسمتُ، ثم
                  غادرتُ المقهى بخطوات هادئة، لكن بروح تشتعل بالشغف، وابتسامة
                  تحمل وعدًا بأنني، منذ هذه اللحظة، سأكون حاضرًا في حياتي حقًا،
                  لا مجرد عابر فيها. لأن الحياة ليست ما ننتظره، بل ما نعيشه
                  الآن.من، ولا أريد أن تفوتني أي نغمة.
                </HighlightedText>{" "}
                <div id="section4">#section4</div>
                <HighlightedText searchTerm={searchTerm}>
                  عزفٌ على أوتار الزمن في زاوية مقهى قديم، جلستُ أراقب عقارب
                  الساعة وهي تتسابق كأنها تهرب من شيء لا أدركه. كانت الأضواء
                  الخافتة تنعكس على الطاولات الخشبية، حيث تجمعت عليها آثار قهوة
                  منسية وسطور كتب مهملة، وكأنها تشهد على قصص لم تكتمل بعد.
                  الهواء مشبع برائحة البن المعتّق، وصوت فيروز الخافت يتساكثر
                  ChatGPT said: عزفٌ على أوتار الزمن في زاوية مقهى قديم، جلستُ
                  أراقب عقارب الساعة وهي تتسابق كأنها تهرب من شيء لا أدركه. كانت
                  الأضواء الخافتة تنعكس على الطاولات الخشبية، حيث تجمعت عليها
                  آثار قهوة منسية وسطور كتب مهملة، وكأنها تشهد على قصص لم تكتمل
                  بعد. الهواء مشبع برائحة البن المعتّق، وصوت فيروز الخافت يتسلل
                  من مذياع قديم، يُغرق المكان في حنينٍ ناعم، كأن الزمن توقف هنا
                  منذ عقود، متحججًا بحنين البشر إلى لحظات مضت. في الخارج، كانت
                  الرياح تعبث بأوراق الأشجار، تحمل معها أسرار العابرين، تهمس بها
                  إلى النوافذ المغلقة، وتتنهد بين الأزقة الضيقة. كم مرة مررتُ
                  بهذه الشوارع دون أن ألاحظ تفاصيلها؟ كم من اللحظات عبرتني دون
                  أن أحتضنها؟ هناك شيء غريب في مرور الأيام، كأنها ترحل دون أن
                  تمنحنا فرصة وداع لائق، أو ربما نحن الذين نظل منشغلين بما هو
                  آتٍ، متجاهلين ما هو بين أيدينا. على الطاولة المجاورة، كان هناك
                  رجل مسنٌّ يحدق في فنجانه كأنه يبحث في أعماقه عن ماضٍ سُرق منه.
                  عيناه تحملان ثقل الزمن، كأنهما تخبئان خلفهما ألف حكاية وحكاية.
                  ترى، هل يندم على شيء؟ هل يتمنى لو يعود به العمر ليحكي قصة
                  أخرى، مختلفة عن التي عاشها؟ قربه، شابٌ يحمل قلمًا بين أصابعه،
                  يكتب بحماس وكأنه يسابق الزمن ليحفر اسمه في ذاكرة الكون. في
                  عينيه وميض الأحلام، لم تخدشه الأيام بعد، ولم تخبُ شعلة الشغف
                  في داخله. بينما هناك، عند النافذة، جلست امرأة تحدّق خارجًا
                  بعينين تائهتين، وكأنها تنتظر أحدًا لن يعود. ربما تنتظر رسالة
                  لم تصل، أو حلمًا تأخر في الوصول، أو ربما تنتظر فقط أن تمضي
                  اللحظة، دون أن تأخذ منها شيئًا آخر. تأملتُ المشهد من حولي، هذا
                  التباين الغريب بين مَن يعيش اللحظة، ومن يحاول الفرار منها،
                  وبين من يحنُّ إلى ما فات، ومن يسابق ما هو قادم. أليس هذا حالنا
                  جميعًا؟ نحن أبناء الزمن، نحبه ونكرهه، نركض خلفه ونفرُّ منه،
                  نغرق في الذكريات ونتعثر في المستقبل. لكن الحقيقة الوحيدة هي أن
                  الزمن يمضي، سواء أردنا ذلك أم لا، فلا هو ينتظرنا، ولا نحن
                  نستطيع إيقافه. سألت نفسي، كم مرة عشتُ اللحظة حقًا؟ كم مرة
                  توقفتُ عن الركض لأتأمل الحياة وهي تمر أمامي؟ ربما حان الوقت
                  لأتوقف عن التفكير في الأمس والغد، لأمنح اليوم فرصة أن يكون
                  يومًا يستحق أن يُعاش. نهضتُ من مكاني، احتسيتُ آخر رشفة من
                  قهوتي، وشعرتُ كأن نكهتها مختلفة هذه المرة، وكأنني أتذوقها لأول
                  مرة. نظرتُ إلى الرجل المسن، إلى الشاب الطموح، إلى المرأة
                  المنتظرة، وإلى الطفل الصغير الذي يلهو في ركن بعيد من المقهى،
                  كأن العالم بين يديه، لم يتلوث بعد بهموم الوقت وضغوط الانتظار.
                  ابتسمتُ، ثم غادرتُ المقهى بخطوات هادئة، لكن بروح تشتعل بالشغف،
                  وابتسامة تحمل وعدًا بأنني، منذ هذه اللحظة، سأكون حاضرًا في
                  حياتي حقًا، لا مجرد عابر فيها. لأن الحياة ليست ما ننتظره، بل
                  ما نعيشه الآن.لل من مذياع قديم، يُغرق المكان في nostalgia
                  ناعمة، كأن الزمن توقف هنا منذ عقود.
                </HighlightedText>{" "}
                <div id="section5">#section5</div>
                <HighlightedText searchTerm={searchTerm}>
                  عزفٌ على أوتار الزمن في زاوية مقهى قديم، جلستُ أراقب عقارب
                  الساعة وهي تتسابق كأنها تهرب من شيء لا أدركه. كانت الأضواء
                  الخافتة تنعكس على الطاولات الخشبية، حيث تجمعت عليها آثار قهوة
                  منسية وسطور كتب مهملة، وكأنها تشهد على قصص لم تكتمل بعد.
                  الهواء مشبع برائحة البن المعتّق، وصوت فيروز الخافت يتسلل من
                  مذياع قديم، يُغرق المكان في nostalgia ناعمة، كأن الزمن توقف
                  هنا منذ عقود. في الخارج، كانت الرياح تعبث بأوراق الأشجار، تحمل
                  معها أسرار العابرين، تهمس بها إلى النوافذ المغلقة، وتتنهد بين
                  الأزقة الضيقة. كم مرة مررتُ بهذه الشوارع دون أن ألاحظ
                  تفاصيلها؟ كم من اللحظات عبرتني دون أن أحتضنها؟ هناك شيء غريب
                  في مرور الأيام، كأنها ترحل دون أن تمنحنا فرصة وداع لائق، أو
                  ربما نحن الذين نظل منشغلين بما هو آتٍ، متجاهلين ما هو بين
                  أيدينا. أدرتُ نظري إلى الوجوه حولي، كل وجه يحمل رواية صامتة،
                  ملامح حكاية مكتومة. هناك رجل مسنٌّ يحدق في فنجانه كأنه يبحث في
                  أعماقه عن ماضٍ سُرق منه، وعاشقة تكتب بحماس وكأنها تسابق الزمن
                  لتحتفظ بوهج المشاعر على ورق قبل أن تخبو، وامرأة تحدّق من
                  النافذة بعينين تائهتين، كأنها تنتظر أحدًا لن يعود. وفي زاوية
                  أخرى، يجلس فتى صغير يلهو بشغف، كأن العالم بين يديه، لم يتلوث
                  بعد بهموم الوقت وضغوط الانتظار. الزمن ليس مجرد عقارب تدور، بل
                  هو أنفاس تُسلب، وأحلام تُطوى، وذكريات تُخزن في زوايا القلب.
                  لكنه أيضًا فرصة أخرى، صباحٌ جديد يولد من رحم الليل، أمل يتسلل
                  بين أصابع اليأس، وابتسامة يمكن أن تصنع فارقًا في حياة أحدهم.
                  أليس غريبًا كيف نركض خلف المستقبل ونحن نهدر الحاضر؟ كيف نظلّ
                  نقلب دفاتر الماضي، باحثين عن لحظة لم نعشها كما يجب؟ نهضتُ من
                  مكاني، احتسيتُ آخر رشفة من قهوتي، وتأملتُ المشهد من حولي،
                  وكأنني أراه للمرة الأولى. قررتُ أن أعيش اللحظة، أن أستمع إلى
                  ضحكات العابرين، أن أشعر بنسيم المساء وهو يلامس وجهي، أن أكتب
                  رسالة لصديق لم أراسله منذ زمن، أن أعانق الحياة كما هي،
                  بأوجاعها وأفراحها، لأن كل ثانية تمضي هي نغمة في لحن الزمن، ولا
                  أريد أن تفوتني أي نغمة. غادرتُ المقهى بخطوات هادئة، لكن بروح
                  تشتعل بالشغف، وابتسامة تحمل وعدًا بأنني، منذ هذه اللحظة، سأكون
                  حااكثر ChatGPT said: عزفٌ على أوتار الزمن في زاوية مقهى قديم،
                  جلستُ أراقب عقارب الساعة وهي تتسابق كأنها تهرب من شيء لا
                  أدركه. كانت الأضواء الخافتة تنعكس على الطاولات الخشبية، حيث
                  تجمعت عليها آثار قهوة منسية وسطور كتب مهملة، وكأنها تشهد على
                  قصص لم تكتمل بعد. الهواء مشبع برائحة البن المعتّق، وصوت فيروز
                  الخافت يتسلل من مذياع قديم، يُغرق المكان في حنينٍ ناعم، كأن
                  الزمن توقف هنا منذ عقود، متحججًا بحنين البشر إلى لحظات مضت. في
                  الخارج، كانت الرياح تعبث بأوراق الأشجار، تحمل معها أسرار
                  العابرين، تهمس بها إلى النوافذ المغلقة، وتتنهد بين الأزقة
                  الضيقة. كم مرة مررتُ بهذه الشوارع دون أن ألاحظ تفاصيلها؟ كم من
                  اللحظات عبرتني دون أن أحتضنها؟ هناك شيء غريب في مرور الأيام،
                  كأنها ترحل دون أن تمنحنا فرصة وداع لائق، أو ربما نحن الذين نظل
                  منشغلين بما هو آتٍ، متجاهلين ما هو بين أيدينا. على الطاولة
                  المجاورة، كان هناك رجل مسنٌّ يحدق في فنجانه كأنه يبحث في
                  أعماقه عن ماضٍ سُرق منه. عيناه تحملان ثقل الزمن، كأنهما تخبئان
                  خلفهما ألف حكاية وحكاية. ترى، هل يندم على شيء؟ هل يتمنى لو
                  يعود به العمر ليحكي قصة أخرى، مختلفة عن التي عاشها؟ قربه، شابٌ
                  يحمل قلمًا بين أصابعه، يكتب بحماس وكأنه يسابق الزمن ليحفر اسمه
                  في ذاكرة الكون. في عينيه وميض الأحلام، لم تخدشه الأيام بعد،
                  ولم تخبُ شعلة الشغف في داخله. بينما هناك، عند النافذة، جلست
                  امرأة تحدّق خارجًا بعينين تائهتين، وكأنها تنتظر أحدًا لن يعود.
                  ربما تنتظر رسالة لم تصل، أو حلمًا تأخر في الوصول، أو ربما
                  تنتظر فقط أن تمضي اللحظة، دون أن تأخذ منها شيئًا آخر. تأملتُ
                  المشهد من حولي، هذا التباين الغريب بين مَن يعيش اللحظة، ومن
                  يحاول الفرار منها، وبين من يحنُّ إلى ما فات، ومن يسابق ما هو
                  قادم. أليس هذا حالنا جميعًا؟ نحن أبناء الزمن، نحبه ونكرهه،
                  نركض خلفه ونفرُّ منه، نغرق في الذكريات ونتعثر في المستقبل. لكن
                  الحقيقة الوحيدة هي أن الزمن يمضي، سواء أردنا ذلك أم لا، فلا هو
                  ينتظرنا، ولا نحن نستطيع إيقافه. سألت نفسي، كم مرة عشتُ اللحظة
                  حقًا؟ كم مرة توقفتُ عن الركض لأتأمل الحياة وهي تمر أمامي؟ ربما
                  حان الوقت لأتوقف عن التفكير في الأمس والغد، لأمنح اليوم فرصة
                  أن يكون يومًا يستحق أن يُعاش. نهضتُ من مكاني، احتسيتُ آخر رشفة
                  من قهوتي، وشعرتُ كأن نكهتها مختلفة هذه المرة، وكأنني أتذوقها
                  لأول مرة. نظرتُ إلى الرجل المسن، إلى الشاب الطموح، إلى المرأة
                  المنتظرة، وإلى الطفل الصغير الذي يلهو في ركن بعيد من المقهى،
                  كأن العالم بين يديه، لم يتلوث بعد بهموم الوقت وضغوط الانتظار.
                  ابتسمتُ، ثم غادرتُ المقهى بخطوات هادئة، لكن بروح تشتعل بالشغف،
                  وابتسامة تحمل وعدًا بأنني، منذ هذه اللحظة، سأكون حاضرًا في
                  حياتي حقًا، لا مجرد عابر فيها. لأن الحياة ليست ما ننتظره، بل
                  ما نعيشه الآن.ضرًا في حياتي حقًا، لا مجرد عابر فيها. You said:
                </HighlightedText>{" "}
                <div id="section6">#section6</div>
                <HighlightedText searchTerm={searchTerm}>
                  عزفٌ على أوتار الزمن في زاوية مقهى قديم، جلستُ أراقب عقارب
                  الساعة وهي تتسابق كأنها تهرب من شيء لا أدركه. كانت الأضواء
                  الخافتة تنعكس على الطاولات الخشبية، حيث تجمعت عليها آثار قهوة
                  منسية وسطور كتب مهملة، وكأنها تشهد على قصص لم تكتمل بعد.
                  الهواء مشبع برائحة البن المعتّق، وصوت فيروز الخافت يتسلل من
                  مذياع قديم، يُغرق المكان في حنينٍ ناعم، كأن الزمن توقف هنا منذ
                  عقود، متحججًا بحنين البشر إلى لحظات مضت. اكثر ChatGPT said:
                  عزفٌ على أوتار الزمن في زاوية مقهى قديم، جلستُ أراقب عقارب
                  الساعة وهي تتسابق كأنها تهرب من شيء لا أدركه. كانت الأضواء
                  الخافتة تنعكس على الطاولات الخشبية، حيث تجمعت عليها آثار قهوة
                  منسية وسطور كتب مهملة، وكأنها تشهد على قصص لم تكتمل بعد.
                  الهواء مشبع برائحة البن المعتّق، وصوت فيروز الخافت يتسلل من
                  مذياع قديم، يُغرق المكان في حنينٍ ناعم، كأن الزمن توقف هنا منذ
                  عقود، متحججًا بحنين البشر إلى لحظات مضت. في الخارج، كانت
                  الرياح تعبث بأوراق الأشجار، تحمل معها أسرار العابرين، تهمس بها
                  إلى النوافذ المغلقة، وتتنهد بين الأزقة الضيقة. كم مرة مررتُ
                  بهذه الشوارع دون أن ألاحظ تفاصيلها؟ كم من اللحظات عبرتني دون
                  أن أحتضنها؟ هناك شيء غريب في مرور الأيام، كأنها ترحل دون أن
                  تمنحنا فرصة وداع لائق، أو ربما نحن الذين نظل منشغلين بما هو
                  آتٍ، متجاهلين ما هو بين أيدينا. على الطاولة المجاورة، كان هناك
                  رجل مسنٌّ يحدق في فنجانه كأنه يبحث في أعماقه عن ماضٍ سُرق منه.
                  عيناه تحملان ثقل الزمن، كأنهما تخبئان خلفهما ألف حكاية وحكاية.
                  ترى، هل يندم على شيء؟ هل يتمنى لو يعود به العمر ليحكي قصة
                  أخرى، مختلفة عن التي عاشها؟ قربه، شابٌ يحمل قلمًا بين أصابعه،
                  يكتب بحماس وكأنه يسابق الزمن ليحفر اسمه في ذاكرة الكون. في
                  عينيه وميض الأحلام، لم تخدشه الأيام بعد، ولم تخبُ شعلة الشغف
                  في داخله. بينما هناك، عند النافذة، جلست امرأة تحدّق خارجًا
                  بعينين تائهتين، وكأنها تنتظر أحدًا لن يعود. ربما تنتظر رسالة
                  لم تصل، أو حلمًا تأخر في الوصول، أو ربما تنتظر فقط أن تمضي
                  اللحظة، دون أن تأخذ منها شيئًا آخر. تأملتُ المشهد من حولي، هذا
                  التباين الغريب بين مَن يعيش اللحظة، ومن يحاول الفرار منها،
                  وبين من يحنُّ إلى ما فات، ومن يسابق ما هو قادم. أليس هذا حالنا
                  جميعًا؟ نحن أبناء الزمن، نحبه ونكرهه، نركض خلفه ونفرُّ منه،
                  نغرق في الذكريات ونتعثر في المستقبل. لكن الحقيقة الوحيدة هي أن
                  الزمن يمضي، سواء أردنا ذلك أم لا، فلا هو ينتظرنا، ولا نحن
                  نستطيع إيقافه. سألت نفسي، كم مرة عشتُ اللحظة حقًا؟ كم مرة
                  توقفتُ عن الركض لأتأمل الحياة وهي تمر أمامي؟ ربما حان الوقت
                  لأتوقف عن التفكير في الأمس والغد، لأمنح اليوم فرصة أن يكون
                  يومًا يستحق أن يُعاش. نهضتُ من مكاني، احتسيتُ آخر رشفة من
                  قهوتي، وشعرتُ كأن نكهتها مختلفة هذه المرة، وكأنني أتذوقها لأول
                  مرة. نظرتُ إلى الرجل المسن، إلى الشاب الطموح، إلى المرأة
                  المنتظرة، وإلى الطفل الصغير الذي يلهو في ركن بعيد من المقهى،
                  كأن العالم بين يديه، لم يتلوث بعد بهموم الوقت وضغوط الانتظار.
                  ابتسمتُ، ثم غادرتُ المقهى بخطوات هادئة، لكن بروح تشتعل بالشغف،
                  وابتسامة تحمل وعدًا بأنني، منذ هذه اللحظة، سأكون حاضرًا في
                  حياتي حقًا، لا مجرد عابر فيها. لأن الحياة ليست ما ننتظره، بل
                  ما نعيشه الآن. في الخارج، كانت الرياح تعبث بأوراق الأشجار،
                  تحمل معها أسرار العابرين، تهمس بها إلى النوافذ المغلقة، وتتنهد
                  بين الأزقة الضيقة. كم مرة مررتُ بهذه الشوارع دون أن ألاحظ
                  تفاصيلها؟ كم من اللحظات عبرتني دون أن أحتضنها؟ هناك شيء غريب
                  في مرور الأيام، كأنها ترحل دون أن تمنحنا فرصة وداع لائق، أو
                  ربما نحن الذين نظل منشغلين بما هو آتٍ، متجاهلين ما هو بين
                  أيدينا.
                </HighlightedText>{" "}
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  );
}

// دالة تنظيف النص العربي من التشكيل والرموز
const cleanArabicText = (text: string) => {
  return text
    .normalize("NFKD") // تطبيع النص
    .replace(/[\u064B-\u065F]/g, "") // إزالة التشكيل
    .replace(/[^\p{L}\s]/gu, ""); // إزالة الرموز غير الحروف
};

function HighlightedText({
  searchTerm,
  children,
}: {
  searchTerm: string;
  children: string;
}) {
  const textRef = useRef<HTMLParagraphElement>(null);

  useEffect(() => {
    if (searchTerm.trim() && textRef.current) {
      const firstMatch = textRef.current.querySelector("mark");
      if (firstMatch) {
        firstMatch.scrollIntoView({ behavior: "smooth", block: "center" });
      }
    }
  }, [searchTerm]);

  if (!searchTerm.trim()) return <p ref={textRef}>{children}</p>;

  const regex = new RegExp(`(${searchTerm})`, "gi");
  const parts = children.split(regex);

  return (
    <p ref={textRef}>
      {parts.map((part, index) =>
        part.toLowerCase() === searchTerm.toLowerCase() ? (
          <mark key={index} className="bg-yellow-300 px-1 cursor-pointer">
            {part}
          </mark>
        ) : (
          part
        )
      )}
    </p>
  );
}
